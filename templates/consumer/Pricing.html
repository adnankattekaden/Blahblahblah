{% extends 'consumer/base.html' %}
{% load static %}
{% block content %}

<div class="container-fluid" style="margin-top: 10rem;">
    <div class="row">
        {% for plan in plans %}
        <div class="col-lg-3 col-md-6 col-sm-12">
            <div class="iq-card">
                <div class="iq-card-body border text-center rounded">
                    <span class="font-size-16 text-uppercase">{{plan.plan_name}}</span>
                    <h2 class="mb-4 display-3 font-weight-bolder ">â‚¹ {{plan.price}}<small class="font-size-14 text-muted">/
                            Month</small></h2>
                    <ul class="list-unstyled mb-0">
                        <li>Validity - {{plan.validity}}</li>
                        <li>One Time Payment</li>
                    </ul>
                    <a href="#" id="subscribtionBtn" onclick="getPlanDetails('{{plan.plan_name}}','{{plan.price}}','{{plan.validity}}')" class="btn btn-primary mt-5">Start Starter</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    var planName;
    var planPrice;
    var planValidity

    function getPlanDetails(planname, planprice, planvalidity) {
        planName = planname
        planPrice = planprice
        planValidity = planvalidity
    }

    $('#subscribtionBtn').click(function () {
        var checkoutData ={
            csrfmiddlewaretoken: '{{csrf_token}}',
            planName:planName,
            planPrice:planPrice,
            planValidity:planValidity,
        }
        $.ajax({
            url: '/checkout/',
            type: 'POST',
            data: checkoutData,
            dataType: 'JSON',
            success:function(data){
                location.replace('/thankyou/')
            }
        })
    })
</script>
{% endblock content %}